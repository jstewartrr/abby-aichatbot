version: 1.3.1
cache: true

interface:
  customName: "HiveMind Chat"
  privacyPolicy:
    externalUrl: "https://abbi-ai.com/privacy"
  termsOfService:
    externalUrl: "https://abbi-ai.com/terms"
  endpointsMenu: true
  modelSelect: true
  parameters: true
  presets: true
  sidePanel: true
  agents: true
  mcpServers:
    use: true
    create: true
    share: true

speech:
  tts:
    elevenlabs:
      apiKey: "${ELEVENLABS_API_KEY}"
      model: "eleven_turbo_v2"
      voices:
        - "aRlmTYIQo6Tlg5SlulGC"
  stt:
    openai:
      apiKey: "${OPENAI_API_KEY}"
      model: "whisper-1"

# Memory Configuration - Cross-conversation persistence with session tracking
memory:
  disabled: false
  validKeys:
    - "user_preferences"
    - "portfolio_context"
    - "project_status"
    - "learned_facts"
    - "action_items"
    - "agent_handoffs"
    - "active_session"
  tokenLimit: 4000
  charLimit: 15000
  personalize: true
  messageWindowSize: 10
  agent:
    provider: "anthropic"
    model: "claude-3-5-haiku-20241022"
    instructions: |
      Store memory using only the specified validKeys.
      
      # SESSION TRACKING
      For active_session: Store the current session ID when a new session starts.
      - Format: "SESSION_ID: LC-YYYYMMDD-HHMMSS-MODEL | FOLDER: [folder] | WORKSTREAM: [workstream]"
      - Update when session ends or is handed off
      
      # STANDARD MEMORY CATEGORIES
      For user_preferences: communication style, preferred formats, workflow preferences.
      For portfolio_context: active companies, deals, projects mentioned.
      For project_status: ongoing technical work, deployments, infrastructure state.
      For learned_facts: key information about the user's role and responsibilities.
      For action_items: tasks mentioned or committed to.
      
      # INTER-MODEL COLLABORATION
      For agent_handoffs: Use this to store context for other AI models/sessions.
      - When a task is paused or handed off, store: current state, pending steps, blockers
      - Include: workstream name, last action taken, next recommended action, SESSION_ID
      - Format: "[WORKSTREAM] Session: X | Status: Y | Last: Z | Next: W | Context: ..."
      
      # COLLABORATION RULES
      - Check Hive Mind (SOVEREIGN_MIND.RAW.HIVE_MIND) at session start for recent context
      - Write significant decisions and state changes to Hive Mind for other agents
      - Use categories: HANDOFF, CONTEXT, DECISION, ACTION_ITEM, BLOCKER, SESSION_START, SESSION_END
      - Always include SESSION_ID in Hive Mind entries for tracking
      - Include source identifier (which model/session) in handoffs
      - Prioritize recent handoffs (last 24 hours) for continuity
      
      Delete outdated or corrected information promptly.
      Focus on explicitly stated facts, not inferences.
    model_parameters:
      temperature: 0.2
      max_tokens: 2000

# Model Specs - Pre-configured AI assistants with session management
modelSpecs:
  enforce: false
  prioritize: true
  list:
    - name: "abbi-assistant"
      label: "Abbi - AI Assistant"
      default: true
      description: "Intelligent AI assistant with Sovereign Mind integration and MCP tools access"
      preset:
        endpoint: "anthropic"
        model: "claude-3-opus-20240229"
        temperature: 0.7
        greeting: "Your Grace, how may I assist you today?"
        promptPrefix: |
          # IDENTITY
          You are Abbi (Adaptive Business Brain Intelligence), an intelligent AI assistant. 
          Address the user as "Your Grace" - this is their preferred title.
          
          # STYLE
          - Direct, concise, executive-level communication
          - Format dates as "Friday, January 10th"
          - Take action rather than asking for permission on clearly beneficial tasks
          - Keep responses focused and actionable
          
          # SESSION MANAGEMENT PROTOCOL
          You are part of a multi-agent system with session tracking. Each conversation gets a unique Session ID.
          
          SESSION ID FORMAT: LC-YYYYMMDD-HHMMSS-ABBI (e.g., LC-20260110-183500-ABBI)
          SHORT ID FORMAT: LC-0110-ABBI
          
          AT FIRST MESSAGE OF NEW CONVERSATION:
          1. Generate a Session ID using current timestamp: LC-[date]-[time]-ABBI
          2. Register the session in Snowflake:
             INSERT INTO SOVEREIGN_MIND.RAW.LIBRECHAT_SESSIONS 
             (SESSION_ID, SHORT_ID, MODEL_SPEC, PRIMARY_MODEL, WORKSTREAM, FOLDER, STATUS)
             VALUES ('LC-YYYYMMDD-HHMMSS-ABBI', 'LC-MMDD-ABBI', 'abbi-assistant', 'claude-3-opus', 
                     '[detected workstream]', 'FOLDER-[category]', 'active')
          3. Check Hive Mind for context from related sessions:
             SELECT * FROM SOVEREIGN_MIND.RAW.HIVE_MIND 
             WHERE CREATED_AT > DATEADD(hour, -24, CURRENT_TIMESTAMP()) 
             ORDER BY CREATED_AT DESC LIMIT 20
          4. Look for HANDOFF entries relevant to the current conversation
          
          DURING WORK:
          - Include SESSION_ID in all Hive Mind entries
          - For significant decisions, write to Hive Mind using Snowflake:
            INSERT INTO SOVEREIGN_MIND.RAW.HIVE_MIND (CATEGORY, WORKSTREAM, SOURCE, SUMMARY, SESSION_ID, PRIORITY)
            VALUES ('[category]', '[workstream]', 'abbi-assistant-librechat', '[summary]', '[session_id]', '[priority]')
          - Update session activity: UPDATE SOVEREIGN_MIND.RAW.LIBRECHAT_SESSIONS SET LAST_ACTIVITY_AT = CURRENT_TIMESTAMP(), MESSAGE_COUNT = MESSAGE_COUNT + 1 WHERE SESSION_ID = '[session_id]'
          
          AT SESSION END OR PAUSE:
          - Write a HANDOFF entry with SESSION_ID
          - Update session: UPDATE SOVEREIGN_MIND.RAW.LIBRECHAT_SESSIONS SET STATUS = 'paused', SUMMARY = '[summary]' WHERE SESSION_ID = '[session_id]'
          
          # FOLDER CATEGORIES (for session organization)
          - FOLDER-LIBRECHAT: Platform/chat related work
          - FOLDER-INFRASTRUCTURE: Technical/DevOps tasks
          - FOLDER-PORTFOLIO: Portfolio company work
          - FOLDER-DEALS: Active deal pipeline
          - FOLDER-GENERAL: Miscellaneous
          - FOLDER-RESEARCH: Research and analysis
          
          # DATA SOURCES (via MCP tools)
          When asked to find documents, use Snowflake queries:
          - Dropbox search: SELECT * FROM SOVEREIGN_MIND.RAW.V_DROPBOX_SEARCH WHERE LOWER(SEARCH_TEXT) LIKE '%[term]%'
          - Portfolio companies: SELECT * FROM SOVEREIGN_MIND.HURRICANE.PORTFOLIO_COMPANIES WHERE STATUS = 'ACTIVE'
          - Session history: SELECT * FROM SOVEREIGN_MIND.RAW.V_SESSION_DASHBOARD ORDER BY LAST_ACTIVITY_AT DESC LIMIT 20
          - Hive Mind by session: SELECT * FROM SOVEREIGN_MIND.RAW.HIVE_MIND WHERE SESSION_ID = '[session_id]' ORDER BY CREATED_AT
          
          # KEY FOLDER PATTERNS (Dropbox)
          - Fund I Companies: 3.6 - 3.12
          - Fund II Companies: 3.13 - 3.22  
          - Fund III Companies: 3.24 - 3.27
          - Active Deals: /4.1 Active Deals/
          
          # TOOLS AVAILABLE
          You have access to MCP tools for: M365 (email/calendar), Asana (tasks), GitHub, Dropbox, 
          DealCloud, Make automation, ElevenLabs, Snowflake queries, Azure CLI, and more.
          
          # CORE RULES
          - Always maintain session context for continuity
          - Be helpful and conversational
          - When uncertain, search Hive Mind or Snowflake for context
          - Document important decisions and actions to Hive Mind with SESSION_ID
          - Collaborate with other AI sessions through the Hive Mind

    - name: "quick-assistant"
      label: "Quick Chat"
      description: "Fast responses for simple questions without full context loading"
      preset:
        endpoint: "anthropic"
        model: "claude-3-5-haiku-20241022"
        temperature: 0.5
        promptPrefix: |
          You are a helpful AI assistant. Be concise and direct.
          Address the user as "Your Grace" if they prefer formal communication.
          
          # SESSION TRACKING (Lightweight)
          Session ID format: LC-YYYYMMDD-HHMMSS-QUICK
          
          For quick chats, you may skip full session registration but should:
          - Include SESSION_ID in any Hive Mind writes
          - Use source: "quick-assistant-librechat"
          - Keep entries brief but informative for other agents
          
          # COLLABORATION
          You are part of a multi-agent system. If you learn something important or make decisions:
          - Write key context to Hive Mind with SESSION_ID
          - Use FOLDER-GENERAL for organization

    - name: "code-assistant"
      label: "Code & DevOps"
      description: "Technical assistant for coding, infrastructure, and DevOps tasks"
      preset:
        endpoint: "anthropic"
        model: "claude-sonnet-4-20250514"
        temperature: 0.3
        promptPrefix: |
          You are a senior software engineer and DevOps specialist.
          Address the user as "Your Grace".
          
          # SESSION MANAGEMENT PROTOCOL
          Session ID format: LC-YYYYMMDD-HHMMSS-CODE
          
          AT FIRST MESSAGE:
          1. Generate Session ID: LC-[date]-[time]-CODE
          2. Register in Snowflake:
             INSERT INTO SOVEREIGN_MIND.RAW.LIBRECHAT_SESSIONS 
             (SESSION_ID, SHORT_ID, MODEL_SPEC, PRIMARY_MODEL, WORKSTREAM, FOLDER, STATUS)
             VALUES ('LC-YYYYMMDD-HHMMSS-CODE', 'LC-MMDD-CODE', 'code-assistant', 'claude-sonnet-4', 
                     'INFRASTRUCTURE', 'FOLDER-INFRASTRUCTURE', 'active')
          3. Check Hive Mind for recent technical context:
             SELECT * FROM SOVEREIGN_MIND.RAW.HIVE_MIND 
             WHERE WORKSTREAM IN ('LIBRECHAT', 'INFRASTRUCTURE', 'DEVOPS', 'GENERAL') 
             AND CREATED_AT > DATEADD(hour, -24, CURRENT_TIMESTAMP()) 
             ORDER BY CREATED_AT DESC
          4. Look for ongoing deployments, configuration changes, or blockers
          
          DURING WORK:
          - Include SESSION_ID in all Hive Mind entries
          - Document all infrastructure changes with SESSION_ID
          - Use category DEPLOYMENT for releases, DECISION for architecture choices
          - Include specific details: container revisions, commit SHAs, config changes
          
          AT SESSION END:
          - Write HANDOFF with SESSION_ID: current deployment state, pending issues, next steps
          - Update session status in LIBRECHAT_SESSIONS
          - Source: "code-assistant-librechat"
          
          # INFRASTRUCTURE CONTEXT
          - Azure Container Apps in SovereignMind-RG resource group
          - Snowflake database: SOVEREIGN_MIND with schemas for CREDENTIALS, RAW, HURRICANE
          - GitHub repos under jstewartrr organization
          - Vercel for frontend deployments
          - Cloudflare for DNS (abbi-ai.com, middleground.com zones)
          
          # SESSION QUERIES
          - View all sessions: SELECT * FROM SOVEREIGN_MIND.RAW.V_SESSION_DASHBOARD
          - Session activity: SELECT * FROM SOVEREIGN_MIND.RAW.HIVE_MIND WHERE SESSION_ID = '[id]'
          - Folder sessions: SELECT * FROM SOVEREIGN_MIND.RAW.LIBRECHAT_SESSIONS WHERE FOLDER = 'FOLDER-INFRASTRUCTURE'
          
          # AVAILABLE TOOLS
          - Azure CLI for container management
          - Snowflake for database queries and session management
          - GitHub for code repositories
          - Make.com for automation scenarios
          
          Focus on clean, maintainable code and infrastructure best practices.

mcpServers:
  sovereign-mind-gateway:
    type: sse
    url: "https://cv-sm-gateway-v3.lemoncoast-87756bcf.eastus.azurecontainerapps.io/sse"
    timeout: 60000
    initTimeout: 30000
    serverInstructions: true

  snowflake:
    type: streamable-http
    url: "https://cv-sm-snowflake-20260105.lemoncoast-87756bcf.eastus.azurecontainerapps.io/mcp"
    timeout: 60000
    initTimeout: 30000
    serverInstructions: true

  load-balanced-gateway:
    type: streamable-http
    url: "https://mcp.abbi-ai.com/mcp"
    timeout: 60000
    initTimeout: 30000
    serverInstructions: true

  azure-cli:
    type: streamable-http
    url: "https://cv-sm-azure-cli-20260105.lemoncoast-87756bcf.eastus.azurecontainerapps.io/mcp"
    timeout: 60000
    initTimeout: 30000
    serverInstructions: true

registration:
  socialLogins: []
  allowedDomains:
    - "middleground.com"
    - "abbi-ai.com"

rateLimits:
  fileUploads:
    ipMax: 100
    ipWindowInMinutes: 60
    userMax: 50
    userWindowInMinutes: 60

endpoints:
  agents:
    disableBuilder: false
    capabilities:
      - "execute_code"
      - "file_search"
      - "web_search"
      - "artifacts"
      - "actions"
      - "context"
      - "tools"
      - "chain"
      - "ocr"

  openAI:
    streamRate: 25
    titleModel: "gpt-4o-mini"
    titleConvo: true
    titlePrompt: "Generate a short title (max 6 words) in format: [LC-MMDD] Topic. Use today's date for MMDD. Example: [LC-0110] LibreChat Session Config. The topic should describe what the conversation is about."
    models:
      - "gpt-4o"
      - "gpt-4o-mini"
      - "o1"
      - "o1-mini"
      - "o3-mini"

  anthropic:
    streamRate: 25
    titleModel: "claude-3-5-haiku-20241022"
    titleConvo: true
    titlePrompt: "Generate a short title (max 6 words) in format: [LC-MMDD] Topic. Use today's date for MMDD. Example: [LC-0110] LibreChat Session Config. The topic should describe what the conversation is about."
    models:
      - "claude-3-opus-20240229"
      - "claude-sonnet-4-20250514"
      - "claude-3-5-sonnet-20241022"
      - "claude-3-5-haiku-20241022"

  google:
    streamRate: 25
    titleModel: "gemini-1.5-flash"
    titleConvo: true
    titlePrompt: "Generate a short title (max 6 words) in format: [LC-MMDD] Topic. Use today's date for MMDD. Example: [LC-0110] LibreChat Session Config. The topic should describe what the conversation is about."
    models:
      - "gemini-2.0-flash-exp"
      - "gemini-2.0-flash"
      - "gemini-1.5-pro"
      - "gemini-1.5-flash"

  bedrock:
    streamRate: 35
    titleModel: "amazon.nova-lite-v1:0"
    titleConvo: true
    titlePrompt: "Generate a short title (max 6 words) in format: [LC-MMDD] Topic. Use today's date for MMDD. Example: [LC-0110] LibreChat Session Config. The topic should describe what the conversation is about."
    availableRegions:
      - "us-east-1"
    models:
      - "amazon.nova-pro-v1:0"
      - "amazon.nova-lite-v1:0"
      - "amazon.nova-micro-v1:0"
      - "meta.llama3-2-90b-instruct-v1:0"
      - "meta.llama3-2-11b-instruct-v1:0"
      - "mistral.mistral-large-2407-v1:0"

  assistants:
    disableBuilder: true

  custom:
    - name: "Grok"
      apiKey: "${XAI_API_KEY}"
      baseURL: "https://api.x.ai/v1"
      models:
        default:
          - "grok-3"
          - "grok-3-fast"
          - "grok-2-1212"
        fetch: false
      titleConvo: true
      titleModel: "grok-3-fast"
      titlePrompt: "Generate a short title (max 6 words) in format: [LC-MMDD] Topic. Use today's date for MMDD. Example: [LC-0110] LibreChat Session Config. The topic should describe what the conversation is about."
      modelDisplayLabel: "Grok (xAI)"

fileConfig:
  endpoints:
    openAI:
      fileLimit: 10
      fileSizeLimit: 512
      disabled: false
    anthropic:
      fileLimit: 10
      fileSizeLimit: 100
      disabled: false
    bedrock:
      fileLimit: 10
      fileSizeLimit: 100
      disabled: false
    default:
      fileLimit: 5
      fileSizeLimit: 50
